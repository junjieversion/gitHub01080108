<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
    <title>Title</title>
    <link rel="stylesheet" href="css/index.css" type="text/css">
</head>
<body>
<div id="wrap">
    <!--头部-->
    <div id="header">
        <!--上半部-->
        <div id="headerTop">
            <h1 id="logo">
                <a href="###"><img src="img/logo.png" alt=""></a>
            </h1>
            <!--菜单按钮-->
            <a href="###" id="menuBtn" class="menuBtnClos"></a>
            <!--三个按钮-->
            <div id="navs">
                <a href="###" id="searchBtn">搜索</a>
                <a href="###">登陆</a>
                <a href="###">注册</a>
            </div>
        </div>
        <!--
                基线问题
                float: right; 问题
                行内元素转成快：display,浮动
                元素选择器优先级（是否为同一个元素） --- 属性分开写，
                    因为简写属性background，font有默认样式
            -->
        <!--下半部-->
        <form id="search">
            <input type="text" placeholder="请输入搜索内容">
            <input type="submit" value="搜索">
        </form>
        <!--
					怪异盒模型 --- IE ：设置padding向里面挤（content-box）

					<input type="text" placeholder="请输入搜索内容"/>
					placeholder字体样式
						::-webkit-input-placeholder

					清除边框 :  border: none;
					input:行内块元素
				-->
        <!--定位层-->
        <ul id="list">
            <li>
                <a href="javascript:;">首页</a>
            </li>
            <li>
                <a href="javascript:;">MV</a>
            </li>
            <li>
                <a href="javascript:;">悦单</a>
            </li>
            <li>
                <a href="javascript:;">V榜</a>
            </li>
            <li>
                <a href="javascript:;">音悦</a>
            </li>
            <li>
                <a href="javascript:;">商城</a>
            </li>
            <li>
                <a href="javascript:;">节目</a>
            </li>
            <li>
                <a href="javascript:;">饭团</a>
            </li>
            <li>
                <a href="javascript:;">资讯</a>
            </li>
            <li>
                <a href="javascript:;">我的家</a>
            </li>
            <li>
                <a href="javascript:;">APP下载</a>
            </li>
            <li>
                <a href="javascript:;">热门应用</a>
            </li>
        </ul>
    </div>

    <!--内容区-->
    <div id="content">
        <!--导航-->
        <div id="navsWrap">
            <ul id="navsList">
                <li class="active">
                    <a href="javascript:;">首页</a>
                </li>
                <li>
                    <a href="javascript:;">MV</a>
                </li>
                <li>
                    <a href="javascript:;">悦单</a>
                </li>
                <li>
                    <a href="javascript:;">V榜</a>
                </li>
                <li>
                    <a href="javascript:;">音悦</a>
                </li>
                <li>
                    <a href="javascript:;">商城</a>
                </li>
                <li>
                    <a href="javascript:;">节目</a>
                </li>
                <li>
                    <a href="javascript:;">饭团</a>
                </li>
                <li>
                    <a href="javascript:;">资讯</a>
                </li>
                <li>
                    <a href="javascript:;">我的家</a>
                </li>
                <li>
                    <a href="javascript:;">APP下载</a>
                </li>
                <li>
                    <a href="javascript:;">热门应用</a>
                </li>
            </ul>
        </div>
    </div>


</div>
</body>
<script type="text/javascript" src="js/transformCss.js"></script>
<script type="text/javascript">
    document.addEventListener('touchstart', function (event) {
        event.preventDefault();
    });

    //rem适配 自调函数
    (function () {
        var width = document.documentElement.clientWidth;
        var styleN = document.createElement('style');
        styleN.innerHTML = 'html{font-size:' + width / 16 + 'px !important;}';
        document.head.appendChild(styleN);
    })();

    //导航交互
    navs();

    function navs() {
        var navsWrap = document.getElementById('navsWrap');
        var navsList = document.getElementById('navsList');

        //定义元素初始位置，手指初始位置
        var eleX = 0;
        var startX = 0;

        //加速
        var beginTime = 0;
        var beginValue = 0;
        var endTime = 0;
        var endValue = 0;
        //距离差时间差
        var disTime = 1;
        var disValue = 0;

        navsWrap.addEventListener("touchstart", function (event) {
            var touch = event.changedTouches[0];

            eleX = transformCss(navsList, 'translateX');
            startX = touch.clientX;

            beginTime = new Date().getTime();//毫秒
            beginValue = eleX;

        });

        navsWrap.addEventListener("touchmove", function (event) {
            var touch = event.changedTouches[0];
            //手指结束位置
            var endX = touch.clientX;
            //手指距离差
            var disX = endX - startX;

            //范围限定
            var translateX = disX + eleX;
            var scale = 0;
            var minX = document.documentElement.clientWidth - navsList.offsetWidth;
            if (translateX > 0) {
                // translateX = 0;
                //比例：越来越小
                //    留白/屏幕宽度 （保证不同机型，实现相同效果）
                //留白 逐渐增大 ，scale逐渐减小，   1-留白/屏幕宽度
                scale = 1 - translateX/document.documentElement.clientWidth;

                translateX = translateX*scale;
            } else if (translateX < minX) {
                // translateX = document.documentElement.clientWidth - navsList.offsetWidth;
                var over = minX - translateX;
                scale = 1 - over/document.documentElement.clientWidth;
                translateX = minX - over*scale;
            }

            transformCss(navsList, 'translateX', translateX);

            endTime = new Date().getTime();
            endValue = translateX;
            disValue = endValue - beginValue;
            disTime = endTime - beginTime;

        });

        navsWrap.addEventListener("touchend", function (event) {
            var touch = event.changedTouches[0];

            //速度
            var speed = disValue / disTime;
            console.log(speed);
        });
    }

    //头部交互
    changeMenu();

    function changeMenu() {
        var menuBtn = document.getElementById('menuBtn');
        var list = document.getElementById('list');

        menuBtn.addEventListener("touchstart", function (event) {
            if (menuBtn.className == 'menuBtnClos') {
                menuBtn.className = 'menuBtnOpen';
                list.style.display = 'block';
            } else if (menuBtn.className == 'menuBtnOpen') {
                menuBtn.className = 'menuBtnClos';
                list.style.display = 'none';
            }

            //取消冒泡
            event.stopPropagation();
        });

        //点击其他区域，遮罩消失
        document.addEventListener("touchstart", function () {
            if (menuBtn.className == 'menuBtnOpen') {
                menuBtn.className = 'menuBtnClos';
                list.style.display = 'none';
            }
        });

        list.addEventListener("touchstart", function (event) {
            //取消冒泡
            event.stopPropagation();
        })
    }

</script>
</html>